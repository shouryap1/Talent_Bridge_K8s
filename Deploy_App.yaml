---
- name: Pull Docker Image of Calculator and Scan with Trivy
  hosts: all

  tasks:
    - name: Start Minikube
      shell: |
        minikube start

    - name: Clone the repository
      shell: |
        git clone https://github.com/shouryap1/Talent_Bridge_K8s.git
        cd Talent_Bridge_K8s

    - name: Scan frontend image
      shell: trivy image shouryap1/frontend:latest

    - name: Scan backend image
      shell: trivy image shouryap1/backend:latest

    - name: Apply Kubernetes configurations
      shell: |
        kubectl apply -f Talent_Bridge_K8s/kub/
